<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø±ÙÙŠÙ‚ Ø§Ù„ØªØ¹Ø§ÙÙŠ Ø§Ù„Ø°ÙƒÙŠ</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Google Font: Tajawal -->
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">

  <style>
    body { font-family: 'Tajawal', sans-serif; background-color: #f8fafc; }
    .chat-container { height: 250px; overflow-y: auto; display: flex; flex-direction: column; }
    .user-msg { background: #dbeafe; align-self: flex-start; padding: 8px; border-radius: 8px; margin: 5px 0; max-width: 80%; }
    .ai-msg { background: #f1f5f9; align-self: flex-end; padding: 8px; border-radius: 8px; margin: 5px 0; max-width: 80%; border: 1px solid #e2e8f0; }
  </style>
</head>
<body class="bg-gray-100 pb-10">

<nav class="bg-blue-600 text-white p-4 shadow-lg mb-6">
  <h1 class="text-xl font-bold text-center">ğŸŒ± Ø±ÙÙŠÙ‚ Ø§Ù„ØªØ¹Ø§ÙÙŠ</h1>
</nav>

<div class="max-w-md mx-auto px-4">
  <div class="bg-white p-4 rounded-xl shadow-sm mb-4 border-r-4 border-blue-500">
    <h2 class="text-sm font-bold text-blue-600 mb-1">Ø§Ù„Ù…Ø§Ù†ÙŠÙØ³ØªÙˆ Ø§Ù„ÙŠÙˆÙ…ÙŠ:</h2>
    <p id="manifesto-display" class="text-gray-700 italic">"Ù‚Ø±Ø§Ø±ÙŠ Ø§Ù„ÙŠÙˆÙ… Ø£Ù‚ÙˆÙ‰ Ù…Ù† Ø±ØºØ¨ØªÙŠ Ø§Ù„Ù…Ø¤Ù‚ØªØ©ØŒ Ø£Ù†Ø§ Ø£Ø³ØªØ­Ù‚ Ø§Ù„Ø­Ø±ÙŠØ©."</p>
  </div>

  <div class="bg-white rounded-xl shadow-md overflow-hidden mb-6">
    <div class="bg-gray-800 text-white p-3 text-sm font-bold flex justify-between">
      <span>ğŸ’¬ Ø§Ù„Ù…Ø±Ø´Ø¯ Ø§Ù„Ø°ÙƒÙŠ</span>
      <span class="text-green-400">â— Ù…ØªØµÙ„</span>
    </div>
    <div id="chat-box" class="chat-container p-4">
      <div class="ai-msg text-sm">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ.. Ø£Ù†Ø§ Ù…Ø¹Ùƒ Ø¯Ø§Ø¦Ù…Ø§Ù‹. ÙƒÙŠÙ ØªØ´Ø¹Ø± Ø§Ù„Ø¢Ù†ØŸ</div>
    </div>
    <div class="p-2 border-t flex">
      <input type="text" id="user-input" placeholder="Ø§ÙƒØªØ¨ Ø´Ø¹ÙˆØ±Ùƒ Ù‡Ù†Ø§..." class="flex-1 p-2 border rounded-r-lg outline-none text-sm">
      <button onclick="sendMessage()" class="bg-blue-600 text-white px-4 rounded-l-lg text-sm font-bold">Ø¥Ø±Ø³Ø§Ù„</button>
    </div>
  </div>

  <div class="bg-white p-5 rounded-xl shadow-md mb-6">
    <h2 class="font-bold mb-4 border-b pb-2">ğŸ“‹ Ø±ÙˆØªÙŠÙ† Ø§Ù„ØªØ¹Ø§ÙÙŠ Ø§Ù„ÙŠÙˆÙ…ÙŠ</h2>
    <div class="space-y-4">
      <label class="flex items-center justify-between cursor-pointer">
        <span>ğŸ˜´ Ù†ÙˆÙ… ÙƒØ§ÙÙ ÙˆÙ…Ø¨ÙƒØ±</span>
        <input id="check-1" type="checkbox" class="w-6 h-6 rounded text-blue-600" onchange="saveChecks()">
      </label>
      <label class="flex items-center justify-between cursor-pointer">
        <span>ğŸƒ Ø­Ø±ÙƒØ© (Ù…Ø´ÙŠ Ø£Ùˆ Ø±ÙŠØ§Ø¶Ø©)</span>
        <input id="check-2" type="checkbox" class="w-6 h-6 rounded text-blue-600" onchange="saveChecks()">
      </label>
      <label class="flex items-center justify-between cursor-pointer">
        <span>ğŸ§  ØªØ±ÙƒÙŠØ² (Ø¹Ù…Ù„ Ø£Ùˆ ØªØ¹Ù„Ù…)</span>
        <input id="check-3" type="checkbox" class="w-6 h-6 rounded text-blue-600" onchange="saveChecks()">
      </label>
    </div>
  </div>

  <button onclick="triggerEmergency()" class="w-full bg-red-500 text-white py-4 rounded-xl font-bold shadow-lg hover:bg-red-600 transition duration-300">
    ğŸ†˜ Ø£Ù†Ø§ ÙÙŠ Ø®Ø·Ø± (Ù„Ø­Ø¸Ø© Ø§Ø´ØªØ¹Ø§Ù„)
  </button>
</div>

<script>
  // Simple chat interactions
  function sendMessage() {
    const input = document.getElementById('user-input');
    const chatBox = document.getElementById('chat-box');
    if (!input.value.trim()) return;

    chatBox.innerHTML += `<div class="user-msg text-sm">${escapeHtml(input.value)}</div>`;

    let reply = "Ø£Ù†Ø§ Ø£Ø³Ù…Ø¹Ùƒ.. ØªØ°ÙƒØ± Ø£Ù† Ø§Ù„Ø´Ø¹ÙˆØ± Ù„ÙŠØ³ Ø­Ù‚ÙŠÙ‚Ø©ØŒ Ù‡Ùˆ Ù…Ø¬Ø±Ø¯ Ø³Ø­Ø§Ø¨Ø© ÙˆØ³ØªÙ…Ø±.";
    const val = input.value;
    if (val.includes("ØªØ¹Ø¨Ø§Ù†") || val.includes("Ø¶Ø¹ÙŠÙ")) reply = "Ù„Ø§ Ø¨Ø£Ø³ Ø¨Ø§Ù„Ø¶Ø¹ÙØŒ Ø§Ù„Ù…Ù‡Ù… Ø£Ù„Ø§ ØªØ³ØªØ³Ù„Ù…. ØªÙ†ÙØ³ Ø¨Ø¹Ù…Ù‚ 5 Ù…Ø±Ø§Øª Ø§Ù„Ø¢Ù†.";
    if (val.includes("ÙØ®ÙˆØ±") || val.includes("Ù†Ø¬Ø­Øª")) reply = "Ù‡Ø°Ø§ Ù‡Ùˆ Ø¨Ø·Ù„Ù†Ø§! Ø§Ø³ØªÙ…Ø±ØŒ ÙƒÙ„ ÙŠÙˆÙ… Ù‡Ùˆ Ø§Ù†ØªØµØ§Ø± Ø¬Ø¯ÙŠØ¯.";

    setTimeout(() => {
      chatBox.innerHTML += `<div class="ai-msg text-sm">${reply}</div>`;
      chatBox.scrollTop = chatBox.scrollHeight;
    }, 600);

    input.value = "";
  }

  function triggerEmergency() {
    alert("âš ï¸ ØªÙ†Ø¨ÙŠÙ‡: Ø§ØªØ±Ùƒ Ù‡Ø§ØªÙÙƒ Ø§Ù„Ø¢Ù†ØŒ Ø§Ø®Ø±Ø¬ Ù…Ù† Ø§Ù„ØºØ±ÙØ©ØŒ Ø§Ø´Ø±Ø¨ Ù…Ø§Ø¡Ù‹ Ø¨Ø§Ø±Ø¯Ø§Ù‹. Ø£Ù†Øª Ø£Ù‚ÙˆÙ‰ Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ù„Ø­Ø¸Ø©!");
  }

  // LocalStorage for checkboxes
  function saveChecks() {
    const checks = [
      document.getElementById('check-1').checked,
      document.getElementById('check-2').checked,
      document.getElementById('check-3').checked
    ];
    try {
      localStorage.setItem('recovery-checks', JSON.stringify(checks));
      console.log("Progress saved locally.");
    } catch (e) {
      console.warn("Could not save to localStorage:", e);
    }
  }

  function loadChecks() {
    try {
      const stored = JSON.parse(localStorage.getItem('recovery-checks') || '[]');
      if (Array.isArray(stored)) {
        document.getElementById('check-1').checked = !!stored[0];
        document.getElementById('check-2').checked = !!stored[1];
        document.getElementById('check-3').checked = !!stored[2];
      }
    } catch (e) {
      console.warn("Could not load checks:", e);
    }
  }

  // basic XSS-escaping for chat messages
  function escapeHtml(text) {
    const div = document.createElement('div');
    div.innerText = text;
    return div.innerHTML;
  }

  // Initialize on load
  document.addEventListener('DOMContentLoaded', () => {
    loadChecks();
  });
</script>

</body>
</html>